<html>

<head>
<title>MasterKey-ExtraField Scanner Installation</title>
<link rel="stylesheet" href="stylesheets/appvet.css">
</head>

<body>

	<h1 id="installation">Tool Installation</h1>
	Installation of the MKEF Scanner tool requires the following
	steps:
	</p>
	<ul>
		<li class="big"><a href="#dependencies" target="rightframe">Step
				1: Install Dependencies</a>
		<li class="big"><a href="#download" target="rightframe">Step
				2: Download and Install MKEF Scanner</a>
		<li class="big"><a href="#envvar" target="rightframe">Step 3:
				Set Environment Variables</a>
		<li class="big"><a href="#conf" target="rightframe">Step 4:
				Configure</a>
		<li class="big"><a href="#test" target="rightframe">Step 5:
				Test</a>
	</ul>

	<hr>
	<h2 id="dependencies">Step 1: Install Dependencies</h2>

	MKEF Scanner requires the installation of Oracle JDK and
	Apache Tomcat. If MKEF Scanner is installed on the same
	server as AppVet, then Oracle JDK and Apache Tomcat should already be
	installed. Otherwise, to install Oracle JDK, see the instructions for
	<a class="underline"
		href="http://appvet.github.io/appvet/dependencies.html#java">Installing
		Oracle JDK</a>. To install Apache Tomcat, see the instructions for
	<a class="underline"
		href="http://appvet.github.io/appvet/dependencies.html#tomcat">Installing
		Apache Tomcat</a>.


	<h2 id="download">Step 2. Download and Install MKEF Scanner</h2>

	<h3>Download</h3>

	<ul>
		<li><b>Step a:</b> Download the latest MKEF Scanner
			binary release <code>android-mkef-tool-1.0-binary.tar.gz</code>
			file from <a class="underline"
			href="https://github.com/AppVet/android-mkef-tool/releases"
			target="_blank">https://github.com/AppVet/android-mkef-tool/releases</a>.</li>
		<li><b>Step b:</b> Extract the compressed file onto your local
			machine (e.g., using <code>tar -zxvf
				android-mkef-tool-1.0-binary.tar.gz</code>)</li>
	</ul>
	<h3>Install</h3>

	Before installing MKEF Scanner, ensure that Apache Tomcat is
	shutdown. Then, from the extracted MKEF Scanner binary
	release:

	<ul>
		<li><b>Step a:</b> Copy the <code>android-mkef-tool.war</code>
			file to <code>$CATALINA_HOME/webapps</code>.</li>
		<li><b>Step b:</b> Copy the <code>android_mkef_files</code>
			directory to your <code>$HOME</code> (i.e., <code>/home/&lt;username&gt</code>)
			directory.</li>
	</ul>

	<h2 id="envvar">Step 3. Set Environment Variable</h2>

	To ensure proper operation of MKEF Scanner, set a global
	environment variable
	<code>$ANDROID_MKEF_FILES_HOME</code>
	to the installation path of your
	<code>android_mkef_files</code>
	directory. For example, if
	<code>android_mkef_files</code>
	was copied to your
	<code>$HOME</code>
	directory , set:

	<p style="text-indent: 5em;">
		<code>$ANDROID_MKEF_FILES_HOME=/home/&lt;username&gt;/android_mkef_files</code>
	</p>

	</code>
	To ensure the proper setting of global environment variables under
	CentOS/RedHat, see
	<a class="underline"
		href="http://appvet.github.io/appvet/environment_variables.html"
		target="rightframe">Setting Global Environment Variables</a>.


	<h2 id="conf">Step 4. Configure</h2>

	Edit the
	<code>$ANDROID_MKEF_FILES_HOME/conf/ToolProperties.xml</code>
	file as follows:

	<h4>ServiceURL</h4>
	Set the
	<code>&lt;appvet:ServiceURL&gt;</code>
	property that defines the URL of the MKEF Scanner tool that
	should be used by AppVet to initiate a connection. If MKEF Scanner is installed on the same server as AppVet, then set
	<code>&lt;appvet:ServiceURL&gt;</code>
	to:
	<p>
	<pre>
		<code>
   &lt;appvet:ServiceURL&gt;http://127.0.0.1:8080/android-mkef-tool&lt;/appvet:ServiceURL&gt;
		</code>
		</pre>
	</p>
	If, however, MKEF Scanner is installed on a different server
	than AppVet (e.g.,
	<code>tools.example.com</code>
	) using SSL and port 443, set
	<code>&lt;appvet:ServiceURL&gt;</code>
	to:

	<p>
	<pre>
		<code>
   &lt;appvet:ServiceURL&gt;https://tools.example.com:8443/android-mkef-tool&lt;/appvet:ServiceURL&gt;
		</code>
		</pre>
	</p>


	Note that the '
	<code>/android-mkef-tool</code>
	' portion of the URL should never be modified.


	<h4>AppVet</h4>
	Set the
	<code>&lt;appvet:AppVet&gt;</code>
	property that defines the AppVet login information. Here, only two
	parameters should be set:
	<code>&lt;appvet:URL&gt;</code>
	and
	<code>&lt;appvet:Password&gt;</code>
	. Set the
	<code>&lt;appvet:URL&gt;</code>
	to the URL of the AppVet server. If AppVet resides on the same server,
	set
	<code>&lt;appvet:URL&gt;</code>
	to:

	<p>
	<pre>
		<code>
   &lt;appvet:URL&gt;http://127.0.0.1:8080/appvet/AppVetServlet&lt;/appvet:URL&gt;
		</code>
		</pre>
	</p>
	If AppVet resides on a different server (e.g.,
	<code>server.mytest.org</code>
	) using SSL and port 8443, set
	<code>&lt;appvet:URL&gt;</code>
	to:

	<p>
	<pre>
		<code>
   &lt;appvet:URL&gt;https://server.mytest.org:8443/appvet/AppVetServlet&lt;/appvet:URL&gt;
		</code>
		</pre>
	</p>

	Note that the '/appvet/AppVetServlet' portion of the URL should never
	be modified.
	<p>
		Next, replace 'mkef-password' with the AppVet password for your
		MKEF Scanner tool in the
		<code>&lt;appvet:Password&gt;</code>
		property:
	<p>
	<pre>
		<code>
   &lt;appvet:Password&gt;mkef-password&lt;/appvet:Password&gt;
		</code>
		</pre>
	</p>

	For more information on Tool Properties, see
	<a class="underline"
		href="http://appvet.github.io/appvet/schemas/ToolProperties.html"
		target="rightframe">Tool Properties</a>.

	<h2 id="test">Step 5. Test</h2>

	To test the proper installation of MKEF Scanner, start the
	tool by starting Apache Tomcat. If AppVet resides on the same server, starting
	Tomcat will start both AppVet and the tool. If AppVet resides on a different
	server, start Tomcat on that server. To start Tomcat, run:
	<br>
	<br>
	<p style="text-indent: 5em;">
		<code># $HOME/apache-tomcat-8.&lt;version&gt;/bin/startup.sh</code>
	</p>
	<br>
	<br>
	<p>
	On the server hosting the tool, open a web browser with the following URL:
	
		<br>
	<br>
	<p style="text-indent: 5em;">
		<code>http/s://&lt;tool_server_host&gt;:&lt;port&gt;/android-mkef-tool/index.html</code>
	</p>
	<br>
	<br>
	<p>
	If the message 'MKEF Scanner is running.' then MKEF Scanner 
	was installed.
	</p>
	<p>
		Next, log into AppVet, upload an app, and view the MKEF Scanner report. The MKEF Scanner status and report are
		shown in Figure 1. 
		</p>
		<br> <br> <br>
	<center>
		<img width="700px" src="images/apk-mkef-tool.png"
			alt="MKEF Scanner Screenshot"> <br> <br>
		<p class="cap">Figure 1. MKEF Scanner.</p>

	</center>
	<br>
	<br>
	<br> If you experience errors connecting to the tool, verify the
	tool adapter properties (on the AppVet server) and verify the tool's
	properties (on the tool server).
	<br>
	<br>
	<br>


</body>

</html>